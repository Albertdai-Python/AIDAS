# AIDAS
## ALDH2 In silico Docking & Activator-Screening
---
### What does each script do?
- `main.py`
  - Downloads *SMILES* and *ZINC_ID* in tranches from `/Input/ZINC-downloader-3D-smi.txt`
  - Writes *ZINC_ID* and *SMILES* into `/SMILES/zinc_compounds.db` with ***sqlite3***
  - Converts compounds from *SMILES* 
  - Uses ***MACCSKeys*** and ***Tanimoto Coefficient*** to compute similarity between compounds and **Alda-1**, a known ALDH2 agonist
  - Outputs `/SMILES/Similarity Ranking.csv`
---
- `zinc_by_dataset.py`
  - ***This is the script for docking!***
  - Grabs compounds listed in `/Input/ligands.txt` and check if they are originally in `Data/`
  - Grab the compounds from `https://zinc.docking.org/substances/{compound}.sdf`
  - Adds *Hydrogens* and *Gasteiger Charge* to compound
  - Rewrites `/Input/ligands.txt` with the available compounds and excludes failed ones
  - Docking
      - Inputs
        - Vina directory is at `/Vina/vina`, which is an executable for Vina 1.2.0
        - `/Data/#{protein}.pdbqt` as macromolecule
        - `/Data/{ligand}.pdbqt` as ligand
        - `/Data/#config.txt` as config file, which contains docking center, grid box size, energy range, and exhaustiveness
      - Outputs
        - `/Logs/{protein}_{ligand}_{iteration}.txt` is the log file, which contains the affinities for nine poses
        - `/Result/{protein}_{ligand}_{iteration}.pdbqt` is the docking position file, which contains the coordinates of the nine poses
---
- `analyze.py`
  - Accepts a threshold value as input, which can filter out low affinity compounds
  - Reads `/Input/ligands.txt` to get list of compounds
  - Writes the protein, ligand, iteration, affinities of the nine positions into `/Analysis/{protein}({threshold}).csv`
---
- `distance_search.py`
  - ***This script calculates the minimum distances of compounds to key residues and implements Pair Score to rank agonist possibility***
  - Defines blacklist as residues that the compound should not interact with, likely because it is the substrate or coenzyme binding site
  - Defines whitelist as residues that the compound should interact with
  - Reads `/Result/{protein}.pdbqt` for blacklist and whitelist residues, saving their coordinates as groups for each residue
  - Reads `/Result/{protein}_{ligand}_{iteration}.pdbqt` for the ***FIRST POSE*** of docking results, saving their coordinates in a group
  - Implements minimum distance algorithm for each ligand / residue pair
    - Takes one atom each from ligand / residue
    - Calculate the ***Euclidean Distance*** between the all atom combinations
    - Outputs minimum distance
  - Implements Pair Score algorithm for each ligand
    - Pair Score = numbers of whitelist residues that are within 4.0Å of the compound
    - If any blacklist residues are within 4.0Å of the compound, automatically set Pair Score to 0
    - Writes protein, ligand, iteration, affinity, and distances to whitelist and blacklist residues into `/Analysis/Residue Distance.csv`
---
- `pose_distribution.py`
  - ***3D SCATTERPLOT with docking position clustering with noise elimination (only first position)***
  - Reads `/Input/ligands.txt` for ligand names
  - Iterates through each ligand: `/Result/{protein}_{ligand}_{iteration}.pdbqt` and read the atom positions of the first position
  - Uses DBSCAN with epsilon value of `1.0` for position clustering
  - Filters out `cluster -1`, which is noise and `cluster 3`, which consists of atoms less than one compound
  - Reads `/Result/{protein}.pdbqt` for atom positions of the protein
  - Adds the protein to the plot with different color
